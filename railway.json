{
  "$schema": "https://railway.app/railway.schema.json",
  "name": "ultra-agent-core-blueprint",
  "description": "Ultra Agent OS â€“ Core Blueprint with API, UI, Worker, PostgreSQL and Redis",
  "deploy": {
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  },
  "services": [
    {
      "name": "ultra-agent-api",
      "source": ".",
      "dockerfilePath": "apps/api/Dockerfile",
      "environment": [
        "production"
      ],
      "healthcheck": {
        "path": "/health",
        "interval": 30,
        "timeout": 10,
        "retries": 5
      },
      "env": {
        "DATABASE_URL": "${{Postgres.DATABASE_URL}}",
        "REDIS_URL": "${{Redis.REDIS_URL}}",
        "NODE_ENV": "production",
        "INTERNAL_API_KEY": {
          "generate": true
        },
        "JWT_SECRET": {
          "generate": true
        },
        "DEFAULT_ADMIN_PASSWORD": {
          "generate": true
        },
        "DATA_DIR": "/data/agent",
        "OLLAMA_URL": ""
      }
    },
    {
      "name": "ultra-agent-worker",
      "source": ".",
      "dockerfilePath": "apps/worker/Dockerfile",
      "environment": [
        "production"
      ],
      "healthcheck": {
        "path": "/health",
        "interval": 30,
        "timeout": 10,
        "retries": 5
      },
      "env": {
        "DATABASE_URL": "${{Postgres.DATABASE_URL}}",
        "REDIS_URL": "${{Redis.REDIS_URL}}",
        "INTERNAL_API_KEY": "${{ultra-agent-api.INTERNAL_API_KEY}}",
        "JWT_SECRET": "${{ultra-agent-api.JWT_SECRET}}",
        "NODE_ENV": "production",
        "DATA_DIR": "/data/agent",
        "OLLAMA_URL": ""
      }
    },
    {
      "name": "ultra-agent-ui",
      "source": ".",
      "dockerfilePath": "apps/ui/Dockerfile",
      "environment": [
        "production"
      ],
      "env": {
        "API_URL": "${{ultra-agent-api.RAILWAY_PUBLIC_URL}}",
        "NODE_ENV": "production"
      }
    }
  ],
  "databases": {
    "Postgres": {
      "version": "15",
      "generator": "POSTGRESQL"
    }
  },
  "redis": {
    "version": "7",
    "generator": "REDIS"
  }
}