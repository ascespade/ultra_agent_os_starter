{
  "$schema": "https://railway.app/railway.schema.json",
  "name": "ultra-agent-core-blueprint",
  "description": "Ultra Agent OS â€“ Core Blueprint with API, UI, Worker, PostgreSQL and Redis",
  "deploy": {
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  },
  "services": [
    {
      "name": "ultra-agent-api",
      "source": ".",
      "dockerfilePath": "apps/api/Dockerfile",
      "healthcheck": {
        "path": "/health",
        "interval": 30,
        "timeout": 10,
        "retries": 5
      },
      "env": {
        "DATABASE_URL": "${{Postgres.DATABASE_URL}}",
        "REDIS_URL": "${{Redis.REDIS_URL}}",
        "NODE_ENV": "production",
        "HOST": "0.0.0.0",
        "INTERNAL_API_KEY": "${{INTERNAL_API_KEY}}",
        "JWT_SECRET": "${{JWT_SECRET}}",
        "DEFAULT_ADMIN_PASSWORD": "${{DEFAULT_ADMIN_PASSWORD}}",
        "DATA_DIR": "/data/agent",
        "OLLAMA_URL": {
          "defaultValue": ""
        },
        "UI_ENABLED": "true",
        "UI_PATH": "/ui"
      }
    },
    {
      "name": "ultra-agent-worker",
      "source": ".",
      "dockerfilePath": "apps/worker/Dockerfile",
      "env": {
        "DATABASE_URL": "${{Postgres.DATABASE_URL}}",
        "REDIS_URL": "${{Redis.REDIS_URL}}",
        "INTERNAL_API_KEY": "${{INTERNAL_API_KEY}}",
        "JWT_SECRET": "${{JWT_SECRET}}",
        "NODE_ENV": "production",
        "DATA_DIR": "/data/agent",
        "OLLAMA_URL": {
          "defaultValue": ""
        }
      }
    }
  ],
  "databases": {
    "Postgres": {
      "version": "15",
      "generator": "POSTGRESQL"
    }
  },
  "redis": {
    "version": "7",
    "generator": "REDIS"
  }
}